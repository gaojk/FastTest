<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>ä¸åŒæ–¹å¼å®ç°çš„æ•°æ®è¡¨å•æ˜¾ç¤º</title>

    <!--å¼•å…¥layuiçš„cssæ–‡ä»¶å’Œjsæ–‡ä»¶-->
    <link type="text/css" href="layui/css/layui.css" rel="stylesheet">
    <script type="text/javascript" src="/layui/layui.js"></script>

</head>
<body>

<!--ç¬¬ä¸€ç§æ–¹å¼-->
<h2 align="center">ç¬¬ä¸€ç§æ–¹å¼-ç®€å•æ•°æ®è¡¨æ ¼ğŸ˜¯</h2>
<table class="layui-hide" id="test" lay-filter="test"></table>

<!--è¡¨æ ¼ä¸Šé¢å¢åŠ æŒ‰é’®-->
<script type="text/html" id="toolbarDemo">
    <div class="layui-btn-container">
        <button class="layui-btn layui-btn-sm" lay-event="getCheckData">è·å–é€‰ä¸­è¡Œæ•°æ®</button>
        <button class="layui-btn layui-btn-sm" lay-event="getCheckLength">è·å–é€‰ä¸­æ•°ç›®</button>
        <button class="layui-btn layui-btn-sm" lay-event="isAll">éªŒè¯æ˜¯å¦å…¨é€‰</button>
    </div>
</script>

<!--è¡¨æ ¼å³ä¾§å¢åŠ æŒ‰é’®-->
<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">æŸ¥çœ‹</a>
    <a class="layui-btn layui-btn-xs" lay-event="edit">ç¼–è¾‘</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">åˆ é™¤</a>
</script>


<!--ä¸ºäº†å®ç°æ•°æ®æ˜¾ç¤ºçš„jsæ–‡ä»¶-->
<script>
    layui.use('table', function () {
        var table = layui.table;

        table.render({
            elem: '#test'
            , url: '/show/requests'
            , toolbar: '#toolbarDemo'
            , title: 'æµ‹è¯•æ•°æ®è¡¨'
            , cellMinWidth: 80 //å…¨å±€å®šä¹‰å¸¸è§„å•å…ƒæ ¼çš„æœ€å°å®½åº¦ï¼Œlayui 2.2.1 æ–°å¢
            , cols: [
                [
                    {type: 'checkbox', fixed: 'left'}
                    , {field: 'requestId', width: 100, title: 'è¯·æ±‚ç¼–å·', sort: true, align: "center"}
                    , {field: 'requestName', width: 100, title: 'è¯·æ±‚åç§°'}
                    , {field: 'requestMethod', width: 100, title: 'è¯·æ±‚æ–¹æ³•'}
                    , {field: 'requestUri', width: 100, title: 'è¯·æ±‚åœ°å€'}
                    , {field: 'requestData', width: 100, title: 'è¯·æ±‚æ•°æ®'}
                    , {field: 'requestDataType', title: 'ç¼–ç æ ¼å¼', sort: true}
                    , {field: 'requestHeader', title: 'è¯·æ±‚æ ‡å¤´', sort: true}
                    , {
                    field: 'requestCreateTime', title: 'åˆ›å»ºæ—¶é—´', sort: true,
                    //ä¼ æ¢æ—¥æœŸ
                    templet: function (row) {
                        return createTime(row.requestCreateTime);
                    }
                }
                    , {
                    field: 'lastUpdateTime', title: 'æ›´æ–°æ—¶é—´', sort: true,
                    //ä¼ æ¢æ—¥æœŸ
                    templet: function (row) {
                        return createTime(row.lastUpdateTime);
                    }
                }
                    , {field: 'right',width:178, align:'center', toolbar: '#barDemo'}
                ]
            ], page: true
        });


        // è¡¨æ ¼å¤´å·¥å…·æ äº‹ä»¶
        table.on('toolbar(test)', function (obj) {
            var checkStatus = table.checkStatus(obj.config.id);
            switch (obj.event) {
                case 'getCheckData':
                    var data = checkStatus.data;
                    layer.alert(JSON.stringify(data));
                    break;
                case 'getCheckLength':
                    var data = checkStatus.data;
                    layer.msg('é€‰ä¸­äº†ï¼š' + data.length + ' ä¸ª');
                    break;
                case 'isAll':
                    layer.msg(checkStatus.isAll ? 'å…¨é€‰' : 'æœªå…¨é€‰');
                    break;
            }
            ;
        });

        //ç›‘å¬è¡Œå·¥å…·äº‹ä»¶
        //ç›‘å¬å·¥å…·æ¡
        table.on('tool(test)', function (obj) {
            var data = obj.data;
            if (obj.event === 'detail') {
                layer.msg('IDï¼š' + data.id + ' çš„æŸ¥çœ‹æ“ä½œ');
            } else if (obj.event === 'del') {
                layer.confirm('çœŸçš„åˆ é™¤è¡Œä¹ˆ', function (index) {
                    obj.del();
                    layer.close(index);
                });
            } else if (obj.event === 'edit') {
                layer.alert('ç¼–è¾‘è¡Œï¼š<br>' + JSON.stringify(data))
            }
        });

    });


</script>

<!-- ä¼ æ¢æ—¥æœŸ -->
<script type="text/javascript">
    function createTime(v) {
        var date = new Date(v);
        var y = date.getFullYear();
        var m = date.getMonth() + 1;
        var d = date.getDate();
        var h = date.getHours();
        var M = date.getMinutes();
        var S = date.getSeconds();
        var str = y + "-" + m + "-" + d + " " + h + ":" + M + ":" + S;
        return str;
    }
</script>


<script>
    layui.use('table', function () {
        var table = layui.table;
        //ç›‘å¬å•å…ƒæ ¼ç¼–è¾‘
        table.on('edit(test)', function (obj) {
            var value = obj.value //å¾—åˆ°ä¿®æ”¹åçš„å€¼
                , data = obj.data //å¾—åˆ°æ‰€åœ¨è¡Œæ‰€æœ‰é”®å€¼
                , field = obj.field; //å¾—åˆ°å­—æ®µ
            layer.msg('[ID: ' + data.id + '] ' + field + ' å­—æ®µæ›´æ”¹ä¸ºï¼š' + value);
        });
    });

</script>


</body>
</html>